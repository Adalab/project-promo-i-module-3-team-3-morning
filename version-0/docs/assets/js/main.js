"use strict";const imageName=document.querySelector(".js-pastename"),imageJob=document.querySelector(".js-pastejob"),imageButtonReset=document.querySelector(".js-reset");function resetUserData(){const e=document.querySelectorAll(".js-input-text");console.log(e);for(const t of e)console.log(t),t.value="";document.querySelector(".js-palette1 .js-palette1").checked=!0,cardElement.classList.remove("js-card-palette2"),cardElement.classList.remove("js-card-palette3"),cardElement.classList.add("js-card-palette1"),localStorage.removeItem("data"),profileImage.style.backgroundImage=`url(${cardUrl})`,profilePreview.style.backgroundImage=`url(${cardUrl})`,shareFormLink.innerHTML="",createLink.classList.add("show"),shareButton.setAttribute("disabled","false"),shareButton.classList.remove("disabled"),getUserName(),getUserJob(),paintPalette()}imageButtonReset.addEventListener("click",resetUserData);const collapsibleTrigger=document.querySelectorAll(".js-collapsible--trigger");function updateCollapsible(e){const t=e.currentTarget.parentElement;if(t.classList.contains("collapsable--open"))t.classList.remove("collapsable--open");else{for(const e of collapsibleTrigger)e.parentElement.classList.remove("collapsable--open");t.classList.add("collapsable--open")}}for(const e of collapsibleTrigger)e.addEventListener("click",updateCollapsible);const inputPalette1=document.querySelector(".js-palette1"),inputPalette2=document.querySelector(".js-palette2"),inputPalette3=document.querySelector(".js-palette3"),cardElement=document.querySelector(".js-card");function paintPalette(){cardElement.classList.remove("js-card-palette1"),cardElement.classList.remove("js-card-palette2"),cardElement.classList.remove("js-card-palette3");let e=document.querySelector(".js-radio:checked");console.log(e),e=e.value,console.log(e),cardElement.classList.add("js-card-palette"+e),localStorage.setItem("palette",e)}inputPalette1.addEventListener("click",paintPalette),inputPalette2.addEventListener("click",paintPalette),inputPalette3.addEventListener("click",paintPalette);const userName=document.querySelector(".js-input-name"),userJob=document.querySelector(".js-input-job"),userMail=document.querySelector(".js-input-email"),userPhone=document.querySelector(".js-input-phone"),userLinkedin=document.querySelector(".js-input-linkedin"),userGithub=document.querySelector(".js-input-github");function getUserName(){document.querySelector(".js-cardname").innerHTML=userName.value||"Nombre Apellido",localStorage.setItem("name",userName.value)}function getUserJob(){document.querySelector(".js-cardjob").innerHTML=userJob.value||"Front end developer",localStorage.setItem("job",userJob.value)}function getUserMail(){document.querySelector(".js-cardemail").href="emailto:"+userMail.value,localStorage.setItem("email",userMail.value)}function getUserPhone(){document.querySelector(".js-cardphone").href="tel:"+userPhone.value,localStorage.setItem("phone",userPhone.value)}function getUserLinkedin(){document.querySelector(".js-cardlinkedin").href=""+userLinkedin.value,localStorage.setItem("linkedin",userLinkedin.value)}function getUserGithub(){document.querySelector(".js-cardgithub").href=""+userGithub.value,localStorage.setItem("github",userGithub.value)}userName.addEventListener("keyup",getUserName),userJob.addEventListener("keyup",getUserJob),userMail.addEventListener("keyup",getUserMail),userPhone.addEventListener("keyup",getUserPhone),userLinkedin.addEventListener("keyup",getUserLinkedin),userGithub.addEventListener("keyup",getUserGithub);const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){var t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,localStorage.setItem("image",profileImage.style.backgroundImage)}function fakeFileClick(){fileField.click()}function getDataFromLocalStorage(){const e=localStorage.getItem("name");null!==e&&(userName.value=e);const t=localStorage.getItem("palette");null!==t&&(document.querySelector(`.js-palette${t} .js-palette${t}`).checked=!0);const r=localStorage.getItem("job");null!==r&&(userJob.value=r);const a=localStorage.getItem("image");null!==a&&(profileImage.style.backgroundImage=a,profilePreview.style.backgroundImage=a);const l=localStorage.getItem("email");null!==l&&(userMail.value=l,document.querySelector(".js-cardemail").href="emailto:"+l);const o=localStorage.getItem("phone");null!==o&&(userPhone.value=o,document.querySelector(".js-cardphone").href="tel:"+o);const n=localStorage.getItem("linkedin");null!==n&&(userLinkedin.value=n,document.querySelector(".js-cardlinkedin").href=n);const s=localStorage.getItem("github");null!==s&&(userGithub.value=s,document.querySelector(".js-cardgithub").href=s)}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage),getDataFromLocalStorage(),paintPalette(),getUserName(),getUserJob();let selectedPalette=document.querySelector(".js-radio:checked");selectedPalette=selectedPalette.value;const userData={palette:selectedPalette,name:userName.value,job:userJob.value,mail:userMail.value,phone:userPhone.value,linkedin:userLinkedin.value,github:userGithub.value},shareButton=document.querySelector("#share_btn"),shareForm=document.querySelector("#share-div"),elementError=document.querySelector(".errorMessage"),elementInputs=document.querySelectorAll("input"),label=document.querySelector("label"),shareFormLink=document.querySelector(".share__create-card");function ValidateEmail(){return!!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(userMail.value)}const validation=()=>{let e=!1;for(let t of elementInputs)""===t.value&&""===userPhone.value&&(e=!0,t.classList.remove("able"),t.classList.add("error"));return!e},sendInfo=()=>{let e=fr.result,t=document.querySelector(".js-radio:checked");t=t.value;const r={palette:t,name:userName.value,job:userJob.value,email:userMail.value,photo:e,phone:userPhone.value,linkedin:userLinkedin.value,github:userGithub.value};if(!1===validation())elementError.innerHTML="*Rellene todos los campos obligatorios.";else if(!1===ValidateEmail())elementError.innerHTML="*Ingrese un correo válido.";else{elementError.innerHTML="",shareButton.classList.add("disabled"),shareButton.setAttribute("disabled","true"),shareForm.classList.add("show");for(let e of elementInputs)""!==e.value&&(e.classList.remove("error"),e.classList.add("able"));fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(r),headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>showUrlUser(e)).catch((function(e){}))}};function showUrlUser(e){const t=document.createElement("a");e.success?(shareForm.classList.remove("show"),t.setAttribute("href",`${e.cardURL}`),t.classList.add("share__create-card--link"),t.setAttribute("target","_blank"),t.innerHTML=`${e.cardURL}`,shareFormLink.appendChild(t),shareTwitter(e.cardURL)):e.error.innerHTML=""}function shareTwitter(e){const t=`https://twitter.com/intent/tweet?text=${encodeURIComponent("He creado está tarjeta con mariCARDis Awesome Profile Cards.")}&url=${e}&hashtags=${encodeURIComponent("adalab, adalaber, frontend, awesomeCards, mariCARDis, promocionIdelisa, mariCARDisCard")}`;document.querySelector("share-container__twitter--link").href=t}shareButton.addEventListener("click",sendInfo);